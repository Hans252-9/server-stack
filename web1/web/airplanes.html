<!DOCTYPE html>
<html>
<head>
<meta charset="utf-8">
<title>Airplanes</title>
<link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css"/>
<style>
  html, body, #map { height: 100%; margin: 0; }
</style>
</head>
<body>

<div id="map"></div>

<script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"></script>
<script>
const map = L.map('map').setView([49.8, 14.5], 7);

L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', {
  maxZoom: 12,
  attribution: '© OpenStreetMap'
}).addTo(map);

// sem dej přesnou URL na tvůj JSON (tu absolutní, co už funguje)
fetch('/airplanes.json')
  .then(r => r.json())
  .then(data => {
    data.forEach(p => {
      if (p.lat != null && p.lon != null) {
        const marker = L.circleMarker([p.lat, p.lon], {
          radius: 6,
          color: 'red',
          fillColor: 'red',
          fillOpacity: 0.9
        }).addTo(map);

        // text do popupu
        const info = `
          <b>${p.callsign ? p.callsign.trim() : 'neznámé'}</b><br>
          ${p.origin_country || ''}<br>
          výška: ${p.alt != null ? Math.round(p.alt) + ' m' : '??'}<br>
          rychlost: ${p.velocity != null ? Math.round(p.velocity * 3.6) + ' km/h' : '??'}

        `;

        marker.bindPopup(info);
      }
    });
  })
  .catch(err => console.error('Chyba při načítání dat:', err));

setInterval(() => location.reload(), 60000);

</script>

</body>
</html>
